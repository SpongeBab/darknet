
---
* å…³äºyolov4çš„è¯¦ç»†ä¿¡æ¯,å®˜æ–¹é“¾æ¥ï¼š[darknet](https://github.com/AlexeyAB/darknet)
---
# ç›®çš„
è¿™ä¸ªé¡¹ç›®æ˜¯å¯¹AlexeyABç‰ˆdarknetæºä»£ç çš„åˆ†æã€‚æœ¬é¡¹ç›®åŸºäº/hgpvision/darknetçš„[é¡¹ç›®](https://github.com/hgpvision/darknet) æ„Ÿè°¢ğŸ‘ã€‚è™½ç„¶å·²ä¸å†æ›´æ–°ï¼Œä½†æ˜¯ä¹Ÿéå¸¸å‰å®³äº†ã€‚
* æœ¬é¡¹ç›®æœ€åˆçš„ç›®çš„æ˜¯å¯¹cç‰ˆyolov4è¿›è¡Œåˆ†æã€‚
* é€æ­¥å®ç°äº†repolusion_loss(å·²å®ç°ï¼[darknrt_with_repo](https://github.com/SpongeBab/darknet/tree/local)ï¼‰

## TODO
1. - [x] repulison_loss ï¼ˆdone)  ï¼ˆç»è¿‡å®ç°å‘ç°ï¼ŒRepulsion Lossæ˜¯ä¸€ä¸ªåªé€‚ç”¨äºä¸¤é˜¶æ®µæ£€æµ‹å™¨çš„æŸå¤±å‡½æ•°ï¼Œä½¿ç”¨åœ¨yoloä¸­ä¼šè®©yoloå®Œå…¨å´©æºƒã€‚ä½ å¯ä»¥ä½¿ç”¨æˆ‘çš„ä»£ç å»æµ‹è¯•ã€‚æœ‰ä»»ä½•ä¸åŒæ„è§éƒ½å¯ä»¥æäº¤issueã€‚ï¼‰  
2.æ”¹è¿›YOLOv4ï¼Œæé«˜mAPã€‚


ä¸ºäº†æ–¹ä¾¿åŒºåˆ†ï¼Œæˆ‘ä»¬å°†æœ€åˆçš„[pjreddie/darknet](https://github.com/pjreddie/darknet)ç§°ä¸ºdarknetã€‚å°†AlexeyABç‰ˆçš„darknetç§°ä¸ºyolov4ã€‚
åŸä½œè€…çš„darknetæ›´å¤šçš„ç›®çš„æ˜¯æƒ³å†™ä¸€ä¸ªç±»ä¼¼äºpytorchæˆ–è€…tensorflowé‚£æ ·çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚æ— å¥ˆä¸€ä¸ªäººçš„åŠ›é‡æ¯”ä¸ä¸Šå¤§å…¬å¸å•Šã€‚ä½†æ˜¯ä¾ç„¶æ˜¯ç¥ä¸€æ ·çš„ğŸ‚ï¼ï¼ˆå„ç§é“¾è¡¨ï¼Œå„ç§æŒ‡é’ˆï¼Œå°¤å…¶æ•´ä¸ªä»£ç çš„é€»è¾‘ï¼ŒçœŸçš„æ˜¯æ¯çœ‹ä¸€æ¬¡ä»£ç å°±è†œæ‹œä¸€æ¬¡ã€‚ã€‚ï¼‰è€Œåˆ°äº†AlexeyABè¿™é‡Œï¼Œè¿›ä¸€æ­¥å°†è¿™ä¸ªæ¡†æ¶çš„æ½œåŠ›å‘æ‰¬å…‰å¤§ï¼Œä¸»è¦æ˜¯å°†æ£€æµ‹çš„åŠŸèƒ½ç»§ç»­è¿›è¡Œå¼€å‘ï¼ˆå› ä¸ºåŸç‰ˆçš„darknetå…¶å®æœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œæƒ³äº†è§£çš„å¯ä»¥å»[darknetå®˜ç½‘](pjreddie/darknet)çœ‹ä¸€çœ‹ã€‚
åŠ å…¥äº†å¤šçº¿ç¨‹ï¼Œå¹¶å‘ï¼Œå†…å­˜ç®¡ç†ï¼Œä»¥åŠå…¶ä»–å„ç§ä¼˜åŒ–ï¼Œä½†æ˜¯ä¸å¥½çš„åœ°æ–¹å°±æ˜¯ä»£ç æ··ä¹±äº†è®¸å¤šï¼Œå› ä¸ºæ˜¯ç›´æ¥åœ¨åŸç‰ˆä»£ç ä¸Šä¿®æ”¹çš„ï¼ŒåŸæ¥çš„éƒ½æ²¡åˆ ï¼Œç›´æ¥æ³¨é‡Šæ‰äº†ã€‚è¿˜æœ‰çš„å°±æ˜¯ç›´æ¥å†™äº†æ–°çš„æ–‡ä»¶ï¼Œå°±æ¯”å¦‚detection_layer.cå…¶å®æ›¿æ¢æˆäº†yolo_layer.c(å› ä¸ºæˆ‘è¦æ‰¾ä¸€ä¸‹lossæ˜¯åœ¨å“ªè®¡ç®—çš„ã€‚ç½‘ä¸ŠæŸ¥æ‰¾èµ„æ–™ï¼Œæ˜¯detection_layer.cï¼Œä½†è¿™æ˜¯åŸç‰ˆdarknetçš„æ–‡ä»¶ã€‚AlexeyABå¤§ç¥æ–°å†™äº†yolo_layer.cã€‚è¯´å®è¯ï¼Œè¿™ä¸ªæ¡†æ¶åˆ°ç°åœ¨å·²ç»éå¸¸éš¾ä»¥ä¿®æ”¹äº†ï¼Œé™¤éæ˜¯ä¸€å¼€å§‹å°±ä»¥è¿™ä¸ªå­¦ä¹ çš„ï¼Œä»yolov1åˆ°v4æ‰€æœ‰ä»£ç å †ç§¯åœ¨ä¸€èµ·ï¼Œä»£ç æ— æ¯”æ··ä¹±ã€‚è™½ç„¶æœ€ç»ˆå®ç°çš„æ£€æµ‹é€Ÿåº¦å¾ˆå¿«ã€‚è¿™æ ·æ˜¯è¿™ä¹ˆå¤šäººå­¦ä¹ yoloçš„åŸå› å§ã€‚ï¼‰

yolov4åŸºæœ¬ä¸Šä¸éœ€è¦ä»»ä½•ä¾èµ–ï¼Œè¿™ä¹Ÿå¾—ç›ŠäºåŸç‰ˆçš„darknetã€‚æˆ‘ç›¸ä¿¡å¾ˆå¤šäººåœ¨è£…pytorchæˆ–è€…tensorflowçš„æ—¶å€™éƒ½å¯èƒ½é‡åˆ°è¿‡è¿™æ ·é‚£æ ·çš„é—®é¢˜ã€‚ä½†æ˜¯yolov4çš„å®‰è£…å®åœ¨æ˜¯éå¸¸ç®€å•ï¼ˆä¸æ¸…æ¥šçš„æ¬¢è¿æŸ¥çœ‹æˆ‘çš„åšå®¢[æ²¡å¾—è¿‡å¥–å­¦é‡‘çš„ç ”ç©¶ç”Ÿ](https://blog.csdn.net/weixin_40557160?spm=1001.2014.3001.5343)ï¼‰ã€‚å¦‚æœæ˜¯cpuä¸Šæ£€æµ‹ï¼Œæµ‹è¯•ï¼Œæ— éœ€å®‰è£…ä»»ä½•ä¾èµ–ï¼ˆopencvåªæ˜¯ä¸ºäº†æ˜¾ç¤ºå›¾ç‰‡ï¼‰ï¼Œå¯ç›´æ¥ç¼–è¯‘è¿è¡Œï¼Œè¿™æ ·çš„å¥½å¤„å°±æ˜¯éå¸¸é€‚åˆè¿ç§»ã€‚å¤šå¹³å°ç§»æ¤ã€‚è¯´ç™½äº†ï¼Œä¸ºå·¥ä¸šè€Œç”Ÿï¼ˆå¾ˆå¤šå…¬å¸ç”¨çš„éƒ½æ˜¯yolov4ã€‚ã€‚ï¼‰ã€‚

yolov4å’Œdarknetv4çš„åŒºåˆ«è®²å®Œäº†ã€‚
è®²ä¸€ä¸‹ä»£ç çš„ä¸»è¦ä¸åŒã€‚
* AlexeyABç‰ˆdarknetä¸åŸç‰ˆçš„åŒºåˆ«
* 1.detection_layer.c->region_layer.c->yolo_layer.c(v4)ã€‚
* 2.[æœ€å¤šå¯ä»¥æ£€æµ‹ç›®æ ‡](https://github.com/AlexeyAB/darknet/issues/3896)
* 3.[yolov3&v4æŸå¤±å‡½æ•°â€”â€”yololayer.cè§£æ](https://blog.csdn.net/qq_33614902/article/details/85063287)
* 4.[cfgæ–‡ä»¶å‚æ•°å«ä¹‰](https://github.com/AlexeyAB/darknet/wiki/CFG-Parameters-in-the-different-layers)  
    [netå‚æ•°](https://github.com/AlexeyAB/darknet/wiki/CFG-Parameters-in-the-%5Bnet%5D-section)
    
## å·²æ³¨é‡Šä»£ç 
1.ä¸»å‡½æ•°ã€‚ï¼ˆdarknet.cï¼‰
2.è®­ç»ƒï¼Œæµ‹è¯•ï¼Œè®¡ç®—mapï¼ˆdetector.c)
3.åŠ è½½cfgæ–‡ä»¶å‡½æ•°ï¼ˆparser.c)
4.åŠ è½½ç½‘ç»œã€‚ï¼ˆnetwork.c)(åŒ…æ‹¬å·ç§¯ï¼Œæ± åŒ–ï¼Œä¸‹é‡‡æ ·ï¼Œä¸Šé‡‡æ ·ï¼Œrouteï¼Œshorcutï¼Œyoloç­‰ï¼‰
5.æœ€é‡è¦çš„æŸå¤±å‡½æ•°ã€‚(yolo_layer.c)
6.iou,ciouï¼Œgiou,diou,ä»¥åŠæ”¹è¿›çš„iogï¼ˆbox.c)
7.NMSã€‚
 
## æˆ‘çš„ä¸€äº›å°æ”¹
1.å¯¹æ£€æµ‹åˆ°çš„ç›®æ ‡è¿›è¡Œè®¡æ•°ã€‚  
2.åªæ£€æµ‹äººã€‚   
3.[æäº¤äº†ä¸€äº›å‡†å¤‡è®­ç»ƒæ•°æ®çš„è„šæœ¬](https://github.com/xiaoxiaopeng1998/darknet/tree/xiaoPeng/scripts/%E8%AE%AD%E7%BB%83%E5%87%86%E5%A4%87)     
4.
   * ä¿å­˜æ—¥å¿—å‘½ä»¤ï¼š`darknet.exe detector train cfg/coco.data cfg/yolov4.cfg yolov4.conv.137 >> log/yolov4-train.log`       
   * [å¯è§†åŒ–lossï¼Œç»˜åˆ¶matlabå›¾ç‰‡](https://github.com/xiaoxiaopeng1998/darknet/tree/xiaoPeng/scripts/%E5%8F%AF%E8%A7%86%E5%8C%96)


å¯¹ç†è§£ç¨‹åºæœ‰å¸®åŠ©çš„issuesï¼š
* [How many objects are detectable in Yolo](https://github.com/AlexeyAB/darknet/issues/3896#)
